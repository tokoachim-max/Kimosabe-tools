<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Sign PDF Online ‚Äì Draw & Add Electronic Signatures | Kimosabe Tools</title>
    <link rel="apple-touch-icon" sizes="180x180" href="https://kimosabe-tools.pages.dev/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kimosabe-tools.pages.dev/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kimosabe-tools.pages.dev/favicon-16x16.png">
    <link rel="manifest" href="https://kimosabe-tools.pages.dev/site.webmanifest">

    <meta property="og:title" content="Kimosabe Tools | Private PDF & Image Suite">
<meta property="og:description" content="Edit, Merge, and Compress files 100% locally in your browser. No server uploads, no tracking.">
<meta property="og:image" content="https://kimosabe-tools.pages.dev/og-image.png">
<meta property="og:url" content="https://kimosabe-tools.pages.dev/">
<meta property="og:type" content="website">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Kimosabe Tools | Private PDF & Image Suite">
<meta name="twitter:description" content="Secure, browser-based tools for your daily tasks.">
<meta name="twitter:image" content="https://kimosabe-tools.pages.dev/og-image.png">
    
    <meta name="description" content="Sign PDF documents online for free. Draw your signature and place it anywhere on your document. 100% private - your files never leave your browser.">
    <meta name="keywords" content="sign pdf, electronic signature, e-sign pdf, private pdf signer, kimosabe tools">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H50NB3F51Q"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-H50NB3F51Q');
    </script>

    <link rel="stylesheet" href="../assets/css/style.css">
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>

    <style>
        .signature-app { display: none; margin-top: 20px; }
        .canvas-container { 
            background: #fff; 
            border: 2px solid #cbd5e1; 
            border-radius: 8px; 
            margin: 20px 0;
            position: relative;
            background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        canvas { width: 100%; height: 250px; touch-action: none; cursor: crosshair; display: block; }
        .controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 20px; }
        
        .btn-sign { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 8px; font-weight: bold; cursor: pointer; width: 100%; font-size: 1.1rem; }
        .btn-clear { background: #64748b; color: white; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; }
        
        .step-card { background: white; padding: 20px; border-radius: 12px; border: 1px solid var(--border); margin-bottom: 20px; }
        .page-preview { color: #64748b; font-size: 0.9rem; margin-bottom: 10px; }

        .support-notice { 
            background: #fffbeb; 
            border: 1px solid #fde68a; 
            padding: 15px; 
            border-radius: 8px; 
            margin-top: 25px; 
            display: none; 
            text-align: center; 
        }
    </style>
</head>
<body>

<header class="header">
    <div class="header-content">
        <nav class="breadcrumb"><a href="../index.html">üè† Home</a> / <span>Sign PDF</span></nav>
        <h1>Sign PDF Privately</h1>
        <p>Your signature stays in your browser. No files are uploaded.</p>
    </div>
</header>

<main class="container">
    <section class="tool-wrapper">
        <div id="drop-zone" class="drop-zone" onclick="document.getElementById('pdfInput').click()">
            <div class="drop-zone-content">
                <span class="icon">‚úçÔ∏è</span>
                <p><strong>Step 1: Upload PDF to Sign</strong></p>
                <span class="file-limit">Processed locally on your device</span>
            </div>
            <input type="file" id="pdfInput" accept="application/pdf" hidden />
        </div>

        <div id="signature-app" class="signature-app">
            <div class="step-card">
                <h3>Step 2: Draw Your Signature</h3>
                <div class="canvas-container">
                    <canvas id="signature-pad"></canvas>
                </div>
                <div class="controls">
                    <button id="clear" class="btn-clear">Clear Drawing</button>
                </div>
            </div>

            <div class="step-card">
                <h3>Step 3: Finalize</h3>
                <p class="page-preview">Signature will be placed on the <strong>bottom-right</strong> of all pages.</p>
                <button id="download-btn" class="btn-sign">Apply Signature & Download</button>
            </div>
        </div>

        <div id="support-box" class="support-notice">
            <p>‚úÖ <strong>Successfully Signed!</strong></p>
            <p style="font-size: 0.9rem; margin: 5px 0 10px 0;">Help keep Kimosabe Tools private and free by supporting the project.</p>
            <a href="../donate.html" style="color: #b45309; font-weight: bold; text-decoration: underline;">Support Us ‚ù§Ô∏è</a>
        </div>

        <div id="status" style="display:none; text-align:center; margin-top:20px;">
            <p id="status-text" style="color: var(--primary); font-weight: bold;">Processing...</p>
        </div>
    </section>

    <nav class="more-tools" style="margin-top: 40px;">
        <h3>Other PDF Tools</h3>
        <div class="tools-grid">
            <a href="edit-pdf.html" class="tool-card"><div class="card-icon">üìù</div><span>Edit PDF</span></a>
            <a href="rotate-split-pdf.html" class="tool-card"><div class="card-icon">‚úÇÔ∏è</div><span>Rotate & Split</span></a>
            <a href="merge-pdf.html" class="tool-card"><div class="card-icon">üîó</div><span>Merge PDF</span></a>
        </div>
    </nav>
</main>

<footer class="footer">
    <nav class="footer-links" style="margin-bottom: 20px;">
        <a href="../about.html">About</a>
        <a href="../contact.html">Contact</a>
        <a href="../privacy.html">Privacy</a>
        <a href="../terms.html">Terms</a>
        <a href="../donate.html" style="color: #b45309; font-weight: bold;">Support Us</a>
    </nav>
    <p>¬© 2026 Kimosabe Tools. Secure Browser Processing.</p>
</footer>

<script>
    const canvas = document.getElementById('signature-pad');
    let signaturePad;

    // Fixed Initialization function
    function initSignaturePad() {
        const ratio = Math.max(window.devicePixelRatio || 1, 1);
        canvas.width = canvas.offsetWidth * ratio;
        canvas.height = canvas.offsetHeight * ratio;
        canvas.getContext("2d").scale(ratio, ratio);
        
        signaturePad = new SignaturePad(canvas, {
            backgroundColor: 'rgba(255, 255, 255, 0)',
            penColor: 'rgb(0, 0, 0)'
        });
    }

    document.getElementById('clear').addEventListener('click', () => signaturePad.clear());

    let pdfBytes;
    let fileName = "";

    document.getElementById('pdfInput').addEventListener('change', async (e) => {
        const file = e.target.files[0];
        if (file) {
            pdfBytes = await file.arrayBuffer();
            fileName = file.name.replace('.pdf', '');
            document.getElementById('signature-app').style.display = 'block';
            document.getElementById('drop-zone').style.display = 'none';
            document.getElementById('support-box').style.display = 'none';
            
            // Re-init canvas after display:block is set
            setTimeout(initSignaturePad, 50); 
        }
    });

    document.getElementById('download-btn').addEventListener('click', async () => {
        if (!signaturePad || signaturePad.isEmpty()) return alert("Please draw your signature first.");

        showStatus("Embedding signature...");
        
        try {
            const { PDFDocument } = PDFLib;
            const pdfDoc = await PDFDocument.load(pdfBytes);
            const sigImage = await pdfDoc.embedPng(signaturePad.toDataURL());
            const sigDims = sigImage.scale(0.25); 

            const pages = pdfDoc.getPages();
            pages.forEach(page => {
                const { width, height } = page.getSize();
                page.drawImage(sigImage, {
                    x: width - sigDims.width - 50,
                    y: 50,
                    width: sigDims.width,
                    height: sigDims.height,
                });
            });

            const savedBytes = await pdfDoc.save();
            const blob = new Blob([savedBytes], { type: "application/pdf" });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${fileName}_signed.pdf`;
            link.click();
            
            hideStatus();
            document.getElementById('support-box').style.display = 'block';
        } catch (err) {
            alert("Error processing PDF.");
            hideStatus();
        }
    });

    function showStatus(msg) {
        document.getElementById('status').style.display = 'block';
        document.getElementById('status-text').innerText = msg;
    }
    function hideStatus() {
        document.getElementById('status').style.display = 'none';
    }
</script>

</body>
</html>
