<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  
  <title>Compress PDF Online ‚Äì Shrink PDF File Size | Kimosabe Tools</title>
  <link rel="apple-touch-icon" sizes="180x180" href="https://kimosabe-tools.pages.dev/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://kimosabe-tools.pages.dev/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://kimosabe-tools.pages.dev/favicon-16x16.png">
    <link rel="manifest" href="https://kimosabe-tools.pages.dev/site.webmanifest">
  <meta name="description" content="Reduce PDF file size without losing quality. Our secure browser-based tool keeps your files private."/>

  <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-H50NB3F51Q"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-H50NB3F51Q');
  </script>

  <link rel="stylesheet" href="../assets/css/style.css"/>

  <style>
    .donate-reminder {
      background: #fffbeb;
      border: 1px dashed #f59e0b;
      border-radius: 8px;
      padding: 15px;
      margin-top: 25px;
      text-align: center;
      animation: fadeIn 0.5s ease-in;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>

<header class="header">
  <div class="header-content">
    <nav class="breadcrumb"><a href="../index.html">üè† Home</a> / <span>Compress PDF</span></nav>
    <h1>Compress PDF</h1>
    <p>Shrink your PDF files while maintaining high quality.</p>
  </div>
</header>

<main class="container">
  <section class="tool-wrapper">
    <div id="drop-zone" class="drop-zone" onclick="document.getElementById('file-input').click()">
      <div class="drop-zone-content">
        <span class="icon">üìÑ</span>
        <p><strong>Click to upload</strong> or drag and drop your PDF here</p>
        <span id="file-name-label" class="file-limit">Maximum size: 50MB</span>
      </div>
      <input type="file" id="file-input" accept=".pdf" hidden />
    </div>

    <div id="status-area" class="status-area" style="display:none; margin-top: 20px; text-align: center;">
      <p id="status-text" style="font-weight: bold;">Processing your PDF...</p>
      <div id="stats" style="margin: 10px 0; font-weight: bold; color: var(--primary);"></div>
      
      <a href="#" id="download-btn" class="donate-btn" style="background: #22c55e; color: white; display: none; text-decoration: none; margin: 0 auto; padding: 12px 24px; border-radius: 8px;">Download Compressed PDF</a>
      
      <div id="donate-reminder" style="display:none;" class="donate-reminder">
        <p style="color: #92400e; margin-bottom: 10px;">Saved you some time? Consider buying me a coffee to keep this tool free! ‚òï</p>
        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
          <a href="../donate.html" style="font-size: 0.9rem; color: #b45309; font-weight: bold; text-decoration: underline;">Support Kimosabe Tools</a>
        </div>
      </div>
    </div>
  </section>

  <hr class="divider">

  <section class="tool-description">
    <h2>Secure Online PDF Compression</h2>
    <p>
      This tool helps you reduce the file size of your PDF documents without noticeable loss of quality. 
      It is perfect for making files small enough for email attachments or faster website loading.
    </p>
    <div class="feature-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
      <div class="feature-item">
        <strong>üîí 100% Private</strong>
        <p>Files are processed in your browser and never touch our servers.</p>
      </div>
      <div class="feature-item">
        <strong>‚ö° Instant Results</strong>
        <p>Optimized algorithms compress your files in seconds.</p>
      </div>
    </div>
  </section>

  <nav class="more-tools" style="margin-top: 40px;">
    <h3>Other Handy Tools</h3>
    <div class="tools-grid">
      <a href="image-compressor.html" class="tool-card"><div class="card-icon">üìÅ</div><span>Image Compressor</span></a>
      <a href="image-resize.html" class="tool-card"><div class="card-icon">üìê</div><span>Resize Image</span></a>
      <a href="image-to-pdf.html" class="tool-card"><div class="card-icon">üìÑ</div><span>Image to PDF</span></a>
      <a href="merge-pdf.html" class="tool-card"><div class="card-icon">üîó</div><span>Merge PDF</span></a>
      <a href="jpg-png.html" class="tool-card"><div class="card-icon">üîÑ</div><span>JPG ‚Üî PNG</span></a>
    </div>
  </nav>
</main>

<footer class="footer">
    <nav class="footer-links">
    <a href="../about.html">About</a>
    <a href="../contact.html">Contact</a> 
    <a href="../privacy.html">Privacy</a>
    <a href="../terms.html">Terms</a>
  </nav>
  <p>¬© 2025 Kimosabe Tools</p>
</footer>

<script>
  const dropZone = document.getElementById('drop-zone');
  const fileInput = document.getElementById('file-input');
  const statusArea = document.getElementById('status-area');
  const statusText = document.getElementById('status-text');
  const downloadBtn = document.getElementById('download-btn');
  const statsDiv = document.getElementById('stats');
  const donateReminder = document.getElementById('donate-reminder');

  let currentDownloadUrl = null;

  fileInput.addEventListener('change', (e) => handleFiles(e.target.files));

  dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.style.borderColor = "var(--primary)";
  });

  dropZone.addEventListener('dragleave', () => {
    dropZone.style.borderColor = "var(--border)";
  });

  dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.style.borderColor = "var(--border)";
    handleFiles(e.dataTransfer.files);
  });

  async function handleFiles(files) {
    const file = files[0];
    if (!file || file.type !== "application/pdf") {
      alert("Please upload a valid PDF file.");
      return;
    }

    if (currentDownloadUrl) URL.revokeObjectURL(currentDownloadUrl);

    statusArea.style.display = "block";
    downloadBtn.style.display = "none";
    donateReminder.style.display = "none";
    statsDiv.innerText = "";
    statusText.innerText = "Compressing " + file.name + "...";
    statusText.style.color = "inherit";

    try {
      const arrayBuffer = await file.arrayBuffer();
      const pdfDoc = await PDFLib.PDFDocument.load(arrayBuffer);
      
      // Optimization: Stripping metadata helps reduce size
      pdfDoc.setTitle("");
      pdfDoc.setAuthor("");
      pdfDoc.setCreator("");
      
      const pdfBytes = await pdfDoc.save({ 
        useObjectStreams: true,
        // This is a browser-level optimization for PDF-Lib
        updateFieldAppearances: false 
      });

      const oldSize = (file.size / 1024).toFixed(1);
      const newSize = (pdfBytes.length / 1024).toFixed(1);
      const saved = Math.max(0, (((file.size - pdfBytes.length) / file.size) * 100)).toFixed(1);

      const blob = new Blob([pdfBytes], { type: "application/pdf" });
      currentDownloadUrl = URL.createObjectURL(blob);
      
      statusText.innerText = "Compression Complete!";
      statsDiv.innerText = `Size: ${oldSize}KB ‚Üí ${newSize}KB (${saved}% saved)`;
      
      downloadBtn.href = currentDownloadUrl;
      downloadBtn.download = `compressed_kimosabe_${Date.now()}.pdf`;
      downloadBtn.style.display = "inline-block";
      donateReminder.style.display = 'block';

    } catch (err) {
      console.error(err);
      statusText.innerText = "Error: This PDF might be encrypted or corrupted.";
      statusText.style.color = "#e11d48";
    }
  }
</script>

</body>
</html>
